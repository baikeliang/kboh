{"version":3,"sources":["webpack:///./app/redux/reducers/auth.js?d351","webpack:///./app/isomorphic-api/ApiClient.js?dc70"],"names":["reducer","isLoaded","load","login","logout","LOAD","LOAD_SUCCESS","LOAD_FAIL","LOGIN","LOGIN_SUCCESS","LOGIN_FAIL","LOGOUT","LOGOUT_SUCCESS","LOGOUT_FAIL","initialState","Map","loaded","state","action","type","set","merge","loading","user","result","error","loggingIn","loginError","loggingOut","logoutError","globalState","console","log","auth","openid","params","__SERVER__","localStorage","jwtToken","types","promise","client","GET","done","res","json","valid","resolve","err","info","reject","name","POST","data","get","methods","ApiClient","args","forEach","method","path","u","req","mode","cache","key","append","body","headers","then"],"mappings":"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","file":"0.461d1cac0e7ceb2404f2.hot-update.js","sourcesContent":["import Immutable from 'immutable'\nimport Promise from 'bluebird'\n\nconst LOAD = 'bohe/auth/LOAD';\nconst LOAD_SUCCESS = 'bohe/auth/LOAD_SUCCESS';\nconst LOAD_FAIL = 'bohe/auth/LOAD_FAIL';\nconst LOGIN = 'bohe/auth/LOGIN';\nconst LOGIN_SUCCESS = 'bohe/auth/LOGIN_SUCCESS';\nconst LOGIN_FAIL = 'bohe/auth/LOGIN_FAIL';\nconst LOGOUT = 'bohe/auth/LOGOUT';\nconst LOGOUT_SUCCESS = 'bohe/auth/LOGOUT_SUCCESS';\nconst LOGOUT_FAIL = 'bohe/auth/LOGOUT_FAIL';\n\nconst initialState =Immutable.Map({\n  loaded: false\n});\n\nexport default function reducer(state = initialState, action = {}) {\n    switch (action.type) {\n        case LOAD:\n            return state.set('loaded', true)\n        case LOAD_SUCCESS:\n            return state.merge({ loading: false, loaded: true, user: action.result })\n        case LOAD_FAIL:\n            return state.merge({ loading: false, loaded: false, user: action.error })\n        case LOGIN:\n            return state.merge({ loggingIn: true })\n        case LOGIN_SUCCESS:\n            return state.merge({ loggingIn: false, user: action.result })\n        case LOGIN_FAIL:\n            return state.merge({ loggingIn: false, user: null, loginError: action.error })\n\n        case LOGOUT:\n            return state.merge({ loggingOut: true })\n        case LOGOUT_SUCCESS:\n            return state.merge({\n                loggingOut: false,\n                user: null\n            })\n        case LOGOUT_FAIL:\n            return state.merge({\n                loggingOut: false,\n                logoutError: action.error\n            })\n        default:\n            return state\n    }\n}\n\n\nexport function isLoaded(globalState) {\n  console.log('LLLLLLLLL'+globalState)\n  return globalState.auth && globalState.auth.loaded;\n}\n\nexport function load({ openid }) {\n    var params = {}\n    console.log('YYYYYY '+openid)\n\n    if (__SERVER__ && openid) {\n\n        params.openid = openid\n\n    } else if (localStorage && localStorage.jwtToken) {\n\n        params.jwtToken = localStorage.jwtToken\n    }\n    return {\n        types: [LOAD, LOAD_SUCCESS, LOAD_FAIL],\n        promise: (client) => client.GET('http://192.168.10.10/userinfo/rest?', { params }, {\n            done: function(res) {\n                console.log('MMMMMM'+res);\n                var user = res.json()\n                console.log('<>>>>')\n                console.log(user)\n                console.log('>>>>>>')\n                if (user.valid == 1) {\n\n                    return Promise.resolve(user)\n                } else {\n                    var err = { info: 'auth' }\n                    return Promise.reject(err)\n                }\n            },\n            error: function(err) {\n                console.log(err)\n                console.log('GGGGGGGGGGGGGG')     \n                return  Promise.reject({ info: 'wire' })\n            }\n        })\n    };\n}\n\n\n\n\nexport function login(name) {\n  return {\n    types: [LOGIN, LOGIN_SUCCESS, LOGIN_FAIL],\n    promise: (client) => client.POST('/login', {\n      data: {\n        name: name\n      }\n    })\n  };\n}\n\nexport function logout() {\n  return {\n    types: [LOGOUT, LOGOUT_SUCCESS, LOGOUT_FAIL],\n    promise: (client) => client.get('/logout')\n  };\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./app/redux/reducers/auth.js\n **/","import Promise from 'bluebird'\nimport fetch from 'isomorphic-fetch'\nimport { URLSearchParams } from 'url-search-params-polyfill'\n\nconst methods = ['GET', 'POST'];\nexport default class ApiClient {\n    constructor(args) {\n        // code\n        methods.forEach((method) =>\n            this[method] = (path, { params, data } = {}, {done,error}) => {\n                ///////////////////////////////\n                var u = new URLSearchParams();\n                console.log(method)\n                var req = {\n                    method: method,\n                    mode: 'cors',\n                    cache: 'default'\n                }\n                if ((method == 'GET') && params) {\n                    for (var key of Object.keys(params)) {\n                      u.append(key, params[key])\n                    }\n                } else if (method == 'POST' && data) {\n\n                    req.body = JSON.stringify(data)\n                    req.headers = {\n                        'Content-Type': 'application/json'\n                    }\n\n                }\n                return fetch(path + u, req).then(done,error)\n            }\n        )\n    }\n\n    // methods\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./app/isomorphic-api/ApiClient.js\n **/"],"sourceRoot":""}